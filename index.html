<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PONDER</title>
    <style>

body {
  margin: 0;
  overflow: hidden;
  background: black url("level.webp") no-repeat center center fixed;
  background-size: contain;
  background-position: center center;
}

        #player {
            position: fixed;
            width: 10%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity:88%;
        }

        @font-face {
            font-family: 'font';
            src: url('font.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

svg {
  width: 100vw;
  opacity: 0.5;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}


        #fullscreen-button {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            color: white;
            text-align: center;
            font-size: 111px;
            cursor: pointer;
            font-family: 'font', sans-serif;
            z-index: 5;
        }

    </style>
</head>
<body>
    <img id="player" src="wisp.gif" alt="Player">
    <div id="fullscreen-button" onclick="toggleFullscreenAndPlayAudio()"><br><br>PONDER</div>

 collision-barriers = <svg version="1.1" id="collision-barriers" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       viewBox="0 0 63.8 63.8" style="enable-background:new 0 0 63.8 63.8;" xml:space="preserve">
    <style type="text/css">
      .st0 {
        fill: #FF0000;
      }
    </style>
    <title>collisions</title>
<polygon class="st0" points="0,0 0,63.8 17.1,63.8 17.1,61.2 29.5,60.5 29.5,57.2 31.9,57.2 33.8,56.7 33.8,53.7 37.3,53.2 
	37.3,50.4 33.7,49.8 51.1,44.5 51.1,42.4 52.2,42.4 52.2,40.3 54.1,40.3 54.1,38.7 55.7,38.7 55.7,36.7 60.8,36.7 60.8,34.4 
	63.8,34.4 63.8,0 "/>
<polygon class="st0" points="44.9,63.8 44.9,56.7 52.4,52.5 54.3,53.7 56.6,53.8 56.6,51.8 62.6,48.4 63.8,49.1 63.8,63.8 "/>
</svg>

    <script>

const player = document.getElementById('player');
const svgBarriers = document.getElementById('collision-barriers');

const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      const playerRect = player.getBoundingClientRect();
      const svgRect = svgBarriers.getBoundingClientRect();
      const deltaX = Math.min(0, svgRect.right - playerRect.right);
      const deltaY = Math.min(0, svgRect.bottom - playerRect.bottom);
      player.style.left = (player.offsetLeft - deltaX) + 'px';
      player.style.top = (player.offsetTop - deltaY) + 'px';
    }
  });
});

observer.observe(player, { root: svgBarriers });



function toggleFullscreenAndPlayAudio() {
            const docElement = document.documentElement;

            if (docElement.requestFullscreen) {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    docElement.requestFullscreen().catch(err => {
                        console.error('Error attempting to enable fullscreen:', err);
                    });
                }
            }
            document.getElementById('fullscreen-button').style.display = 'none';
        }

        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', function(event) {
                var y = event.beta;
                var x = event.gamma;
                var movementSpeedX = x * 0.1;
                var movementSpeedY = y * 0.1;
                var player = document.getElementById('player');
                var newX = player.offsetLeft + movementSpeedX;
                var newY = player.offsetTop + movementSpeedY;
                var maxX = window.innerWidth - player.clientWidth;
                var maxY = window.innerHeight - player.clientHeight;
                newX = Math.min(Math.max(newX, 0), maxX);
                newY = Math.min(Math.max(newY, 0), maxY);
                player.style.left = newX + 'px';
                player.style.top = newY + 'px';
            });
        } else {
            alert("Device orientation is not supported on this device.");
        }
        if (!document.documentElement.requestFullscreen) {
            document.getElementById('fullscreen-button').style.display = 'none';
        }

    </script>
</body>
</html>
